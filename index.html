<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Beat Ball</title>
    <style>
        body { margin: 0; font-family: Arial, sans-serif; background: #222; color: white; text-align: center; }
        canvas { display: none; }
        #menu, #login-screen { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0, 0, 0, 0.8); padding: 20px; border-radius: 10px; }
        button { padding: 10px 20px; margin: 5px; background: #444; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #666; }
        #leaderboardList { margin-top: 20px; }
        input { padding: 10px; margin: 5px; width: 200px; }
    </style>
</head>
<body>
    <div id="login-screen">
        <h2>Logowanie / Rejestracja</h2>
        <input type="text" id="nickname" placeholder="Nick" maxlength="15"><br>
        <input type="password" id="password" placeholder="Hasło"><br>
        <button onclick="loginOrRegister()">Zaloguj / Zarejestruj</button>
        <p id="login-message"></p>
    </div>
    <div id="menu" style="display: none;">
        <h1>Beat Ball</h1>
        <button onclick="startGame()">Start</button><br>
        <button onclick="showLeaderboard()">Leaderboard</button><br>
        <button onclick="logout()">Wyloguj</button>
    </div>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <div id="gameInfo" style="display: none;">
        <p>Score: <span id="score">0</span></p>
        <p>Level: <span id="level">1</span></p>
        <button id="pauseBtn" onclick="togglePause()">Pause</button>
    </div>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const menu = document.getElementById('menu');
        const gameInfo = document.getElementById('gameInfo');
        const scoreDisplay = document.getElementById('score');
        const levelDisplay = document.getElementById('level');
        const loginScreen = document.getElementById('login-screen');
        const leaderboardList = document.createElement('div');
        leaderboardList.id = 'leaderboardList';

        let score = 0, level = 1, balls = [], paddle = { x: 350, y: 550, width: 100, height: 10 }, isPaused = false, isGameOver = false, user = null;

        function loginOrRegister() {
            const nickname = document.getElementById('nickname').value.trim();
            const password = document.getElementById('password').value;
            if (nickname && password) {
                const users = JSON.parse(localStorage.getItem('users') || '{}');
                if (users[nickname]) {
                    if (users[nickname].password === password) {
                        user = nickname;
                        document.getElementById('login-message').textContent = 'Zalogowano!';
                        setTimeout(() => {
                            loginScreen.style.display = 'none';
                            menu.style.display = 'block';
                        }, 500);
                    } else {
                        document.getElementById('login-message').textContent = 'Błędne hasło!';
                    }
                } else {
                    users[nickname] = { password, highScore: 0 };
                    localStorage.setItem('users', JSON.stringify(users));
                    user = nickname;
                    document.getElementById('login-message').textContent = 'Zarejestrowano i zalogowano!';
                    setTimeout(() => {
                        loginScreen.style.display = 'none';
                        menu.style.display = 'block';
                    }, 500);
                }
            } else {
                document.getElementById('login-message').textContent = 'Wprowadź nick i hasło!';
            }
        }

        function logout() {
            user = null;
            menu.style.display = 'none';
            loginScreen.style.display = 'block';
            document.getElementById('nickname').value = '';
            document.getElementById('password').value = '';
            document.getElementById('login-message').textContent = '';
        }

        function startGame() {
            menu.style.display = 'none';
            canvas.style.display = 'block';
            gameInfo.style.display = 'block';
            score = 0;
            level = 1;
            balls = [{ x: 400, y: 300, dx: 4, dy: -4, radius: 10 }];
            isGameOver = false;
            isPaused = false;
            gameLoop();
        }

        function togglePause() {
            isPaused = !isPaused;
            document.getElementById('pauseBtn').textContent = isPaused ? 'Resume' : 'Pause';
            if (!isPaused && !isGameOver) gameLoop();
            if (isPaused) showLeaderboard();
        }

        function gameLoop() {
            if (isPaused || isGameOver) return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawPaddle();
            balls.forEach((ball, index) => {
                ball.x += ball.dx;
                ball.y += ball.dy;
                if (ball.x + ball.radius > canvas.width || ball.x - ball.radius < 0) ball.dx *= -1;
                if (ball.y - ball.radius < 0) ball.dy *= -1;
                if (ball.y + ball.radius > paddle.y && ball.x > paddle.x && ball.x < paddle.x + paddle.width) {
                    ball.dy *= -1;
                    score += 10;
                    if (score % 50 === 0) levelUp();
                }
                if (ball.y > canvas.height) balls.splice(index, 1);
                drawBall(ball);
            });
            scoreDisplay.textContent = score;
            levelDisplay.textContent = level;
            if (balls.length === 0) gameOver();
            else requestAnimationFrame(gameLoop);
        }

        function drawPaddle() {
            canvas.addEventListener('mousemove', (e) => {
                const rect = canvas.getBoundingClientRect();
                paddle.x = e.clientX - rect.left - paddle.width / 2;
                if (paddle.x < 0) paddle.x = 0;
                if (paddle.x + paddle.width > canvas.width) paddle.x = canvas.width - paddle.width;
            });
            ctx.fillStyle = 'white';
            ctx.fillRect(paddle.x, paddle.y, paddle.width, paddle.height);
        }

        function drawBall(ball) {
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
            ctx.fillStyle = 'red';
            ctx.fill();
            ctx.closePath();
        }

        function levelUp() {
            level++;
            balls.push({ x: 400, y: 300, dx: 4 + level, dy: -4 - level, radius: 10 });
        }

        function gameOver() {
            isGameOver = true;
            canvas.style.display = 'none';
            gameInfo.style.display = 'none';
            saveScore(score);
            menu.style.display = 'block';
        }

        function saveScore(score) {
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            if (users[user].highScore < score) {
                users[user].highScore = score;
                localStorage.setItem('users', JSON.stringify(users));
            }
        }

        function showLeaderboard() {
            menu.appendChild(leaderboardList);
            leaderboardList.innerHTML = '<h2>Leaderboard</h2>';
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            const scores = Object.entries(users)
                .map(([nick, data]) => ({ nick, score: data.highScore }))
                .sort((a, b) => b.score - a.score)
                .slice(0, 10);
            scores.forEach((entry, index) => {
                const div = document.createElement('div');
                div.textContent = `${index + 1}. ${entry.nick}: ${entry.score}`;
                leaderboardList.appendChild(div);
            });
        }
    </script>
</body>
</html>
​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​